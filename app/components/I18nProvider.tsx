"use client";

import React, { createContext, useContext, useEffect, useMemo, useState } from "react";

export type Language = "tr" | "en";

interface I18nContextValue {
  language: Language;
  setLanguage: (lang: Language) => void;
  t: (key: string) => string;
}

const I18nContext = createContext<I18nContextValue | undefined>(undefined);

const STORAGE_KEY = "mooncrm_lang";

const dictTr: Record<string, string> = {
  "sidebar.dashboard": "Kontrol Paneli",
  "sidebar.header.home": "ANA SAYFA",
  "sidebar.header.customers": "MÜŞTERİ İŞLEMLERİ",
  "sidebar.header.whatsapp": "WHATSAPP",
  "sidebar.header.reports": "RAPOR",
  "sidebar.header.marketing": "PAZARLAMA",
  "sidebar.header.users": "KULLANICI İŞLEMLERİ",
  "sidebar.header.settings": "GENEL AYARLAR",
  "sidebar.customers": "Müşteriler",
  "sidebar.appointments": "Randevular",
  "sidebar.doctors": "Doktorlar",
  "sidebar.chats": "Sohbetler",
  "sidebar.stats": "İstatistikler",
  "sidebar.reports": "Raporlar",
  "sidebar.segments": "Segmentler",
  "sidebar.campaignStatuses": "Kampanya Durumları",
  "sidebar.users": "Kullanıcılar",
  "sidebar.timesheets": "Mesai Takip",
  "sidebar.settings": "Ayarlar",

  "settings.page.title": "Ayarlar",
  "settings.page.subtitle": "Genel sistem ve entegrasyon ayarlarını yönetin.",
  "settings.campaigns.title": "Kampanyalar / Kategoriler",
  "settings.campaigns.subtitle": "Lead Form ID'leri üst kategori ve kampanya başlıklarıyla eşleştirin.",
  "settings.campaigns.new": "Yeni Kayıt",
  "common.save": "Kaydet",
  "common.cancel": "İptal",

  // Dashboard
  "dashboard.card.customers": "Toplam Müşteriler",
  "dashboard.card.sales": "Toplam Satışlar",
  "dashboard.card.offers": "Toplam Teklifler",
  "dashboard.card.conversion": "Dönüşüm Oranı",
  "dashboard.card.trend.increase": "artış son 1 ayda",
  "dashboard.card.trend.decrease": "azalış son 1 ayda",
  "dashboard.chart.title": "Müşteri Kazanımı",
  "dashboard.chart.last12Months": "Son 12 Ay",
  "dashboard.chart.series.customers": "Müşteri Sayısı",
  "dashboard.chart.series.offers": "Teklif Sayısı",
  "dashboard.chart.series.sales": "Satış Sayısı",
  "dashboard.reminders.title": "Yaklaşan Hatırlatmalar",
  "dashboard.reminders.empty": "Aktif hatırlatma yok.",
  "dashboard.reminders.noNote": "Not girilmemiş.",

  // Campaign settings page
  "campaigns.page.title": "Kampanyalar / Kategoriler",
  "campaigns.page.subtitle": "Zapier'den gelen Facebook Lead Form ID'lerini; üst kategori (kaynak), kampanya başlığı ve Lead Form ID ile eşleştirin. Yeni lead'ler bu bilgileri kullanarak otomatik olarak doğru kategoriye kaydedilecektir.",
  "campaigns.page.new": "Yeni Kayıt",
  "campaigns.table.parent": "Üst Kategori",
  "campaigns.table.name": "Kategori Başlığı",
  "campaigns.table.leadFormId": "Lead Form ID",
  "campaigns.table.edit": "Düzenle",
  "campaigns.table.empty": "Henüz kayıtlı kampanya yok. \"Yeni Kayıt\" butonuyla ilk eşleştirmeyi ekleyin.",
  "campaigns.dialog.editTitle": "Kampanyayı Düzenle",
  "campaigns.dialog.newTitle": "Yeni Kampanya",
  "campaigns.dialog.topParent": "Üst Kategori",
  "campaigns.dialog.nodeType.folder": "Klasör",
  "campaigns.dialog.nodeType.category": "Kategori",
  "campaigns.dialog.parentNode": "Üst Düğüm (isteğe bağlı)",
  "campaigns.dialog.rootOption": "Üst düzey (sadece üst kategori altında)",
  "campaigns.dialog.folderName": "Klasör Adı",
  "campaigns.dialog.categoryName": "Kategori Adı",
  "campaigns.dialog.leadFormId": "Lead Form ID",
  "campaigns.dialog.leadFormId.help": "Facebook / Meta lead form ID'sini tam olarak girin.",
  "campaigns.dialog.cancel": "İptal",
  "campaigns.dialog.save": "Kaydet",

  // Stats page
  "stats.page.title": "İstatistikler",
  "stats.page.subtitle": "Üst kategori, kampanya ve danışman bazlı performans analizi",
  "stats.export.csv": "CSV Dışa Aktar",
  "stats.filters.dateFrom": "Başlangıç Tarihi",
  "stats.filters.dateTo": "Bitiş Tarihi",
  "stats.filters.parent": "Üst Kategori",
  "stats.filters.category": "Kategori",
  "stats.filters.advisor": "Danışman",
  "stats.filters.all": "Tümü",
  "stats.summary.totalLeads": "Toplam Lead",
  "stats.summary.totalSales": "Toplam Satış",
  "stats.summary.conversion": "Dönüşüm Oranı (Satış / Lead)",
  "stats.summary.filtered": "Filtrelenen Kayıtlar",
  "stats.parent.title": "Üst Kategori Bazlı Lead / Satış",
  "stats.parent.table.parent": "Üst Kategori",
  "stats.common.lead": "Lead",
  "stats.common.sale": "Satış",
  "stats.common.conversionPct": "Dönüşüm %",
  "stats.parent.empty": "Kayıt bulunamadı.",
  "stats.parent.chart.title": "Üst Kategori Lead Dağılımı",
  "stats.parent.chart.noData": "Gösterilecek veri yok.",
  "stats.category.title": "Kategori Bazlı Detay",
  "stats.category.table.category": "Kategori",
  "stats.category.empty": "Kayıt bulunamadı.",
  "stats.advisor.title": "Danışman Bazlı Kırılım",
  "stats.advisor.table.advisor": "Danışman",
  "stats.advisor.empty": "Kayıt bulunamadı.",

  // Customers page
  "customers.page.title": "Müşteriler",
  "customers.actions.new": "Yeni Müşteri",
  "customers.actions.export": "Excel'e Aktar",
  "customers.search.placeholder": "Search...",
  "customers.columns.id": "#ID",
  "customers.columns.date": "Kayıt Tarihi",
  "customers.columns.advisor": "Danışman",
  "customers.columns.name": "Ad Soyad",
  "customers.columns.phone": "Telefon",
  "customers.columns.category": "Kategori",
  "customers.columns.status": "Durum",
  "customers.columns.service": "Hizmetler",
  "customers.actions.detail": "Detay / Düzenle",
  "customers.actions.delete": "Sil",
  "customers.confirm.delete": "Bu kaydı silmek istediğinize emin misiniz?",
  "customers.snackbar.updated": "Güncellendi",
  "customers.snackbar.deleted": "Silindi",
  "customers.snackbar.created": "Müşteri eklendi",
  "customers.modal.newTitle": "Yeni Müşteri Ekle",
  "customers.modal.name": "Ad Soyad",
  "customers.modal.phone": "Telefon",
  "customers.modal.advisor": "Danışman",
  "customers.modal.status": "Durum",
  "customers.modal.service": "Hizmet",
  "customers.modal.category": "Kategori",
  "customers.modal.cancel": "İptal",
  "customers.modal.save": "Ekle",

  // Customer detail page
  "customerDetail.tabs.personal": "Kişisel Bilgiler",
  "customerDetail.tabs.status": "Durum Bilgileri",
  "customerDetail.tabs.reminder": "Hatırlatıcı",
  "customerDetail.tabs.calls": "Telefon Görüşmeleri",
  "customerDetail.tabs.payment": "Ödeme",
  "customerDetail.tabs.files": "Dosyalar",
  "customerDetail.tabs.history": "Değişiklik Geçmişi",
  "customerDetail.tabs.sales": "Satış",
  "customerDetail.sidebar.save.idle": "Kaydet",
  "customerDetail.sidebar.save.saving": "Kaydediliyor...",
  "customerDetail.header.back": "Listeye Dön",
  "customerDetail.header.helper": "Bilgileri buradan düzenleyebilirsiniz",
  "customerDetail.personal.name": "Ad Soyad *",
  "customerDetail.personal.email": "E-Posta",
  "customerDetail.personal.phone": "Telefon *",
  "customerDetail.personal.country": "Ülke *",
  "customerDetail.personal.notes": "Notlar",
  "customerDetail.personal.registerDate": "Kayıt Tarihi",
  "customerDetail.facebook.title": "Facebook Lead Bilgileri",
  "customerDetail.facebook.adName": "Reklam Adı",
  "customerDetail.facebook.formId": "Form ID",
  "customerDetail.status.consultant": "Danışman *",
  "customerDetail.status.category": "Kategori *",
  "customerDetail.status.services": "Hizmetler",
  "customerDetail.status.status": "Durum",
  "customerDetail.reminder.status.title": "Hatırlatma Durumu",
  "customerDetail.reminder.status.active": "Aktif - WhatsApp gönderilecek",
  "customerDetail.reminder.status.passive": "Pasif",
  "customerDetail.reminder.datetime": "Hatırlatma Tarihi ve Saati",
  "customerDetail.reminder.datetime.helper": "Lütfen tarih ve saat seçiniz",
  "customerDetail.reminder.message": "Hatırlatma Mesajı",
  "customerDetail.reminder.message.placeholder": "WhatsApp mesajı olarak gönderilecek metni yazın...",
  "customerDetail.calls.title": "Yeni Görüşme Ekle",
  "customerDetail.calls.subtitle": "Müşteriniz ile yapılan görüşmeleri kaydedin",
  "customerDetail.calls.button.full": "Yeni Görüşme Ekle",
  "customerDetail.calls.past": "Geçmiş Görüşmeler",
  "customerDetail.payment.notes": "Ödeme Notları",
  "customerDetail.payment.placeholder": "Ödeme ile ilgili notları buraya giriniz...",
  "customerDetail.files.select": "Dosya Seç",
  "customerDetail.files.upload": "Yükle",
  "customerDetail.files.cancel": "İptal",
  "customerDetail.files.dropTitle": "Dosya Yüklemek İçin Sürükleyin",
  "customerDetail.files.dropSubtitle": "veya dosya seçmek için tıklayın",
  "customerDetail.history.systemSample": "Hatırlatma güncellendi",
  "customerDetail.history.old": "Eski: -",
  "customerDetail.history.new": "Yeni: Arandı",
  "customerDetail.sales.infoTitle": "Satış Bilgileri",
  "customerDetail.sales.date": "Satış Tarihi",
  "customerDetail.sales.healthNotes": "Sağlık Notları",
  "customerDetail.sales.healthNotes.placeholder": "Sadece kayıt amaçlı sağlık notlarını buraya yazabilirsiniz.",
  "customerDetail.sales.feedbackTitle": "Müşteri Geri Bildirimleri",
  "customerDetail.sales.feedback.trustpilot": "Trustpilot Yorumu Yapıldı",
  "customerDetail.sales.feedback.googleMaps": "Google Maps Yorumu Yapıldı",
  "customerDetail.sales.feedback.survey": "Memnuniyet Anketi Dolduruldu",
  "customerDetail.sales.feedback.warranty": "Garanti Belgesi Gönderildi",
  "customerDetail.sales.feedback.rpt": "RPT",
  "customerDetail.sales.trip.appointmentDate": "Randevu Tarihi",
  "customerDetail.sales.trip.appointmentTime": "Randevu Saati",
  "customerDetail.sales.trip.doctor": "Doktor",
  "customerDetail.sales.trip.service": "Hizmet",
  "customerDetail.sales.trip.hotel": "Otel",
  "customerDetail.sales.trip.roomType": "Oda Tipi",
  "customerDetail.sales.trip.peopleCount": "Kişi Sayısı",
  "customerDetail.sales.trip.transfer": "Transfer",
  "customerDetail.sales.trip.notes": "Seyahat Notları",
  "customerDetail.sales.trip.ticketArrival": "Geliş Bilet Bilgisi",
  "customerDetail.sales.trip.ticketDeparture": "Dönüş Bilet Bilgisi",
  "customerDetail.snackbar.saved": "Kaydedildi!",
  "customerDetail.snackbar.error": "Hata oluştu.",
  "customerDetail.snackbar.callAddedFull": "Görüşme eklendi! Dashboard'da görünmesi için 'Kaydet' butonuna basın.",
  "customerDetail.snackbar.callAddedQuick": "Görüşme eklendi! Lütfen kaydedin.",

  // WhatsApp page
  "whatsapp.title": "Sohbetler",
  "whatsapp.tab.chat": "WhatsApp",
  "whatsapp.tab.qr": "QR Code",
  "whatsapp.accessDenied.title": "Yetkisiz Erişim",
  "whatsapp.accessDenied.body": "Bu sayfaya sadece Admin, Danışman ve Operasyon rollerine sahip kullanıcılar erişebilir.",
  "whatsapp.noSession.title": "WhatsApp Oturumu Tanımlı Değil",
  "whatsapp.noSession.body": "Bu kullanıcı için Evolution içinde tanımlı bir WhatsApp oturumu (session) bulunamadı. Lütfen sistem yöneticinize başvurun.",
  "whatsapp.qr.title": "WhatsApp Bağlantısı",
  "whatsapp.qr.session": "Oturum:",
  "whatsapp.qr.helper": "Telefonunuzdaki WhatsApp Business uygulamasından bu QR kodu tarayarak hattınızı Evolution'a bağlayın.",
  "whatsapp.qr.button": "QR Kodunu Göster",
  "whatsapp.qr.error.fetch": "QR kodu alınamadı",
  "whatsapp.qr.error.invalid": "Geçersiz QR yanıtı",
  "whatsapp.qr.error.server": "Sunucu hatası oluştu",

  // Reports page
  "reports.advisor.title": "Danışman Raporları",
  "reports.advisor.subtitle": "Danışmanlara göre performans analizi",
  "reports.advisor.summary.totalContacts": "Kontak Sayısı",
  "reports.advisor.summary.totalSales": "Toplam Satış",
  "reports.advisor.summary.offerRate": "Teklif Oranı",
  "reports.advisor.summary.saleRate": "Satış Oranı",
  "reports.advisor.summary.cancelRate": "İptal Oranı",
  "reports.advisor.table.advisor": "Danışman",
  "reports.advisor.table.total": "Kontak Sayısı",
  "reports.advisor.table.offer": "Teklif",
  "reports.advisor.table.offerPct": "Teklif %",
  "reports.advisor.table.sale": "Satış",
  "reports.advisor.table.salePct": "Satış %",
  "reports.advisor.table.cancel": "Satış İptal",
  "reports.advisor.table.cancelPct": "Satış İptal %",
  "reports.advisor.actions.export": "Excel'e Aktar",
  "reports.advisor.defaultAdvisor": "Diğer",
};

const dictEn: Record<string, string> = {
  "sidebar.dashboard": "Dashboard",
  "sidebar.header.home": "HOME",
  "sidebar.header.customers": "CUSTOMERS",
  "sidebar.header.whatsapp": "WHATSAPP",
  "sidebar.header.reports": "REPORTS",
  "sidebar.header.marketing": "MARKETING",
  "sidebar.header.users": "USER MANAGEMENT",
  "sidebar.header.settings": "SETTINGS",
  "sidebar.customers": "Customers",
  "sidebar.appointments": "Appointments",
  "sidebar.doctors": "Doctors",
  "sidebar.chats": "Chats",
  "sidebar.stats": "Statistics",
  "sidebar.reports": "Reports",
  "sidebar.segments": "Segments",
  "sidebar.campaignStatuses": "Campaign Statuses",
  "sidebar.users": "Users",
  "sidebar.timesheets": "Time Tracking",
  "sidebar.settings": "Settings",

  "settings.page.title": "Settings",
  "settings.page.subtitle": "Manage general system and integration settings.",
  "settings.campaigns.title": "Campaigns / Categories",
  "settings.campaigns.subtitle": "Map Lead Form IDs to parent sources and campaign titles.",
  "settings.campaigns.new": "New Record",
  "common.save": "Save",
  "common.cancel": "Cancel",

  // Dashboard
  "dashboard.card.customers": "Total Customers",
  "dashboard.card.sales": "Total Sales",
  "dashboard.card.offers": "Total Offers",
  "dashboard.card.conversion": "Conversion Rate",
  "dashboard.card.trend.increase": "increase in last 1 month",
  "dashboard.card.trend.decrease": "decrease in last 1 month",
  "dashboard.chart.title": "Customer Acquisition",
  "dashboard.chart.last12Months": "Last 12 Months",
  "dashboard.chart.series.customers": "Customers",
  "dashboard.chart.series.offers": "Offers",
  "dashboard.chart.series.sales": "Sales",
  "dashboard.reminders.title": "Upcoming Reminders",
  "dashboard.reminders.empty": "No active reminders.",
  "dashboard.reminders.noNote": "No note entered.",

  // Campaign settings page
  "campaigns.page.title": "Campaigns / Categories",
  "campaigns.page.subtitle": "Map Facebook Lead Form IDs from Zapier to parent sources, campaign titles and Lead Form IDs. New leads will be automatically stored under the correct category.",
  "campaigns.page.new": "New Record",
  "campaigns.table.parent": "Parent Category",
  "campaigns.table.name": "Category Name",
  "campaigns.table.leadFormId": "Lead Form ID",
  "campaigns.table.edit": "Edit",
  "campaigns.table.empty": "No campaigns defined yet. Use the 'New Record' button to add your first mapping.",
  "campaigns.dialog.editTitle": "Edit Campaign",
  "campaigns.dialog.newTitle": "New Campaign",
  "campaigns.dialog.topParent": "Top Parent",
  "campaigns.dialog.nodeType.folder": "Folder",
  "campaigns.dialog.nodeType.category": "Category",
  "campaigns.dialog.parentNode": "Parent Node (optional)",
  "campaigns.dialog.rootOption": "Top level (directly under top parent)",
  "campaigns.dialog.folderName": "Folder Name",
  "campaigns.dialog.categoryName": "Category Name",
  "campaigns.dialog.leadFormId": "Lead Form ID",
  "campaigns.dialog.leadFormId.help": "Enter the Facebook / Meta lead form ID exactly.",
  "campaigns.dialog.cancel": "Cancel",
  "campaigns.dialog.save": "Save",

  // Stats page
  "stats.page.title": "Statistics",
  "stats.page.subtitle": "Performance analysis by parent category, campaign and advisor",
  "stats.export.csv": "Export CSV",
  "stats.filters.dateFrom": "Start Date",
  "stats.filters.dateTo": "End Date",
  "stats.filters.parent": "Parent Category",
  "stats.filters.category": "Category",
  "stats.filters.advisor": "Advisor",
  "stats.filters.all": "All",
  "stats.summary.totalLeads": "Total Leads",
  "stats.summary.totalSales": "Total Sales",
  "stats.summary.conversion": "Conversion Rate (Sales / Lead)",
  "stats.summary.filtered": "Filtered Records",
  "stats.parent.title": "Parent Category Based Leads / Sales",
  "stats.parent.table.parent": "Parent Category",
  "stats.common.lead": "Lead",
  "stats.common.sale": "Sale",
  "stats.common.conversionPct": "Conversion %",
  "stats.parent.empty": "No records found.",
  "stats.parent.chart.title": "Parent Category Lead Distribution",
  "stats.parent.chart.noData": "No data to display.",
  "stats.category.title": "Category Level Details",
  "stats.category.table.category": "Category",
  "stats.category.empty": "No records found.",
  "stats.advisor.title": "Advisor Breakdown",
  "stats.advisor.table.advisor": "Advisor",
  "stats.advisor.empty": "No records found.",

  // Customers page
  "customers.page.title": "Customers",
  "customers.actions.new": "New Customer",
  "customers.actions.export": "Export to Excel",
  "customers.search.placeholder": "Search...",
  "customers.columns.id": "#ID",
  "customers.columns.date": "Created At",
  "customers.columns.advisor": "Advisor",
  "customers.columns.name": "Full Name",
  "customers.columns.phone": "Phone",
  "customers.columns.category": "Category",
  "customers.columns.status": "Status",
  "customers.columns.service": "Services",
  "customers.actions.detail": "Detail / Edit",
  "customers.actions.delete": "Delete",
  "customers.confirm.delete": "Are you sure you want to delete this record?",
  "customers.snackbar.updated": "Updated",
  "customers.snackbar.deleted": "Deleted",
  "customers.snackbar.created": "Customer created",
  "customers.modal.newTitle": "Add New Customer",
  "customers.modal.name": "Full Name",
  "customers.modal.phone": "Phone",
  "customers.modal.advisor": "Advisor",
  "customers.modal.status": "Status",
  "customers.modal.service": "Service",
  "customers.modal.category": "Category",
  "customers.modal.cancel": "Cancel",
  "customers.modal.save": "Add",

  // Customer detail page
  "customerDetail.tabs.personal": "Personal Info",
  "customerDetail.tabs.status": "Status Info",
  "customerDetail.tabs.reminder": "Reminder",
  "customerDetail.tabs.calls": "Phone Calls",
  "customerDetail.tabs.payment": "Payment",
  "customerDetail.tabs.files": "Files",
  "customerDetail.tabs.history": "Change History",
  "customerDetail.tabs.sales": "Sales",
  "customerDetail.sidebar.save.idle": "Save",
  "customerDetail.sidebar.save.saving": "Saving...",
  "customerDetail.header.back": "Back to list",
  "customerDetail.header.helper": "You can edit the information here",
  "customerDetail.personal.name": "Full Name *",
  "customerDetail.personal.email": "Email",
  "customerDetail.personal.phone": "Phone *",
  "customerDetail.personal.country": "Country *",
  "customerDetail.personal.notes": "Notes",
  "customerDetail.personal.registerDate": "Created At",
  "customerDetail.facebook.title": "Facebook Lead Info",
  "customerDetail.facebook.adName": "Ad Name",
  "customerDetail.facebook.formId": "Form ID",
  "customerDetail.status.consultant": "Advisor *",
  "customerDetail.status.category": "Category *",
  "customerDetail.status.services": "Services",
  "customerDetail.status.status": "Status",
  "customerDetail.reminder.status.title": "Reminder Status",
  "customerDetail.reminder.status.active": "Active - WhatsApp will be sent",
  "customerDetail.reminder.status.passive": "Inactive",
  "customerDetail.reminder.datetime": "Reminder Date & Time",
  "customerDetail.reminder.datetime.helper": "Please select date and time",
  "customerDetail.reminder.message": "Reminder Message",
  "customerDetail.reminder.message.placeholder": "Write the message that will be sent via WhatsApp...",
  "customerDetail.calls.title": "Add New Call",
  "customerDetail.calls.subtitle": "Log calls with your customer",
  "customerDetail.calls.button.full": "Add New Call",
  "customerDetail.calls.past": "Past Calls",
  "customerDetail.payment.notes": "Payment Notes",
  "customerDetail.payment.placeholder": "Enter payment related notes here...",
  "customerDetail.files.select": "Select File",
  "customerDetail.files.upload": "Upload",
  "customerDetail.files.cancel": "Cancel",
  "customerDetail.files.dropTitle": "Drag files here to upload",
  "customerDetail.files.dropSubtitle": "or click to select files",
  "customerDetail.history.systemSample": "Reminder updated",
  "customerDetail.history.old": "Old: -",
  "customerDetail.history.new": "New: Called",
  "customerDetail.sales.infoTitle": "Sales Information",
  "customerDetail.sales.date": "Sales Date",
  "customerDetail.sales.healthNotes": "Health Notes",
  "customerDetail.sales.healthNotes.placeholder": "You can write health notes here for record keeping.",
  "customerDetail.sales.feedbackTitle": "Customer Feedback",
  "customerDetail.sales.feedback.trustpilot": "Trustpilot review done",
  "customerDetail.sales.feedback.googleMaps": "Google Maps review done",
  "customerDetail.sales.feedback.survey": "Satisfaction survey completed",
  "customerDetail.sales.feedback.warranty": "Warranty document sent",
  "customerDetail.sales.feedback.rpt": "RPT",
  "customerDetail.sales.trip.appointmentDate": "Appointment Date",
  "customerDetail.sales.trip.appointmentTime": "Appointment Time",
  "customerDetail.sales.trip.doctor": "Doctor",
  "customerDetail.sales.trip.service": "Service",
  "customerDetail.sales.trip.hotel": "Hotel",
  "customerDetail.sales.trip.roomType": "Room Type",
  "customerDetail.sales.trip.peopleCount": "People Count",
  "customerDetail.sales.trip.transfer": "Transfer",
  "customerDetail.sales.trip.notes": "Travel Notes",
  "customerDetail.sales.trip.ticketArrival": "Arrival Ticket Info",
  "customerDetail.sales.trip.ticketDeparture": "Departure Ticket Info",
  "customerDetail.snackbar.saved": "Saved!",
  "customerDetail.snackbar.error": "An error occurred.",
  "customerDetail.snackbar.callAddedFull": "Call added! Click 'Save' for it to appear on the dashboard.",
  "customerDetail.snackbar.callAddedQuick": "Call added! Please save.",

  // WhatsApp page
  "whatsapp.title": "Conversations",
  "whatsapp.tab.chat": "WhatsApp",
  "whatsapp.tab.qr": "QR Code",
  "whatsapp.accessDenied.title": "Unauthorized Access",
  "whatsapp.accessDenied.body": "Only users with Admin, Advisor or Operations roles can access this page.",
  "whatsapp.noSession.title": "No WhatsApp Session Defined",
  "whatsapp.noSession.body": "No WhatsApp session is defined for this user in Evolution. Please contact your system administrator.",
  "whatsapp.qr.title": "WhatsApp Connection",
  "whatsapp.qr.session": "Session:",
  "whatsapp.qr.helper": "Scan this QR code from the WhatsApp Business app on your phone to connect your line to Evolution.",
  "whatsapp.qr.button": "Show QR Code",
  "whatsapp.qr.error.fetch": "Could not retrieve QR code",
  "whatsapp.qr.error.invalid": "Invalid QR response",
  "whatsapp.qr.error.server": "A server error occurred",

  // Reports page
  "reports.advisor.title": "Advisor Reports",
  "reports.advisor.subtitle": "Performance analysis by advisor",
  "reports.advisor.summary.totalContacts": "Total Contacts",
  "reports.advisor.summary.totalSales": "Total Sales",
  "reports.advisor.summary.offerRate": "Offer Rate",
  "reports.advisor.summary.saleRate": "Sale Rate",
  "reports.advisor.summary.cancelRate": "Cancel Rate",
  "reports.advisor.table.advisor": "Advisor",
  "reports.advisor.table.total": "Contacts",
  "reports.advisor.table.offer": "Offers",
  "reports.advisor.table.offerPct": "Offer %",
  "reports.advisor.table.sale": "Sales",
  "reports.advisor.table.salePct": "Sale %",
  "reports.advisor.table.cancel": "Cancelled Sales",
  "reports.advisor.table.cancelPct": "Cancelled Sales %",
  "reports.advisor.actions.export": "Export to Excel",
  "reports.advisor.defaultAdvisor": "Other",
};

function getDict(lang: Language): Record<string, string> {
  return lang === "en" ? dictEn : dictTr;
}

export function I18nProvider({ children }: { children: React.ReactNode }) {
  const [language, setLanguageState] = useState<Language>("tr");

  useEffect(() => {
    try {
      const stored = window.localStorage.getItem(STORAGE_KEY) as Language | null;
      if (stored === "tr" || stored === "en") {
        setLanguageState(stored);
      }
    } catch {}
  }, []);

  const setLanguage = (lang: Language) => {
    setLanguageState(lang);
    try {
      window.localStorage.setItem(STORAGE_KEY, lang);
    } catch {}
  };

  const value = useMemo<I18nContextValue>(() => {
    const dict = getDict(language);
    const t = (key: string) => dict[key] || key;
    return { language, setLanguage, t };
  }, [language]);

  return <I18nContext.Provider value={value}>{children}</I18nContext.Provider>;
}

export function useI18n() {
  const ctx = useContext(I18nContext);
  if (!ctx) {
    throw new Error("useI18n must be used within I18nProvider");
  }
  return ctx;
}
